---
- name: awx
  hosts: "{{ ansible_limit | default('localhost', true) }}"
  connection: "{{ 'local' if (ansible_limit | default('localhost', true) == 'localhost') else 'ssh' }}"
  gather_facts: false
  become: false

  environment:

    TOWER_HOST: https://awx-dev.cloudmason.org
    TOWER_USERNAME: admin
    TOWER_PASSWORD: !vault |
      $ANSIBLE_VAULT;1.1;AES256
      64616437633033333939396365383030656563396331666231616633613532623033353633366130
      3564663965643433336634353462386231363063623065650a336462346135373637363064393461
      63386163383165376666656636663034323331353932333564346239383666346631643962363036
      3833366335663237380a623331316530626433373532343961666135323262633762313931353833
      35303234356333396461356132653365373461666631383631626537353261663163653537663333
      3437343532663531333039323933333463346530396661316365

  vars:

    config:
      organizations:
        - name: Cloudmason
          description: Cloudmason
      teams:
        - name: Cloudmason
          description: Cloudmason
          organization: Cloudmason
      projects:
        - name: Cloudmason
          description: Cloudmason
          organization: Cloudmason
          scm_type: git
          scm_url: https://github.com/mamercad/mamercad.cloudmason.git
      inventories:
        - name: Cloudmason
          description: Cloudmason
          organization: Cloudmason
      inventory_sources:
        - name: Cloudmason
          description: Cloudmason
          organization: Cloudmason
          inventory: Cloudmason
          source: scm
          source_project: Cloudmason
          source_path: inventory/cloudmason.yml
          overwrite: true
          update_cache_timeout: 3600
          update_on_project_update: true

    user:
      group: awx
      name: awx
      comment: AWX Service Account
      shell: /bin/bash
      home: /home/awx
      ssh:
        authorized_keys: |
          ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQDfqDbmj069e3+TSG5oCY31aATY+iQNU9c61kGQhXjNaQyKd57krwElcV0Wp1i2tiXzVztLRBXquqstOYe38AvH9eXi1NcELauglJPNWv+UlBRjuxWUESEe0A6PGobW6Nd6c1GpIKrUgb7J/7bRhdEeXv3Irkw4Xtbamuv9lLckgH3XPiV54rgvth17iLLE1wgSkfEt64RvrP0cyOAyeLgDbu7wmr0vY+3rEA4iF80/yZW+ZzK0524eXBS1wpuKkMvhU1HJYyQhnAlEanq7pnFVd2mTXZ8PsAbrzCsjOF0I14hYlxEPWf0aonKHGAvR3J2ltY4OvzVbKnIDg1CUzR2NZILAvSoNICxE10NQuVCx5X8BpD6A8tBBBVVL9CzM7MSpCjpYh31ZX/9IaHFxCryGTSNBlMAyWvVUlu7GaL8EDv4+3ks86+YqEVmw+feoaT+Mx/mIm3tVCyV3KbXDDm6Pfg2Qfv4ny83to3Wh5b5+qafaJ0VoiIxUJWndvqN1VTTgB13OdXnAoQ454Y1YVgeH/DWYL4Nw8vow0UUdzjA+wjtP9xTyyJiEu/FIFPTib+f3uI4eyfq78fuut0pshDBdO3sh5sAtZcVRo91jCYDC8ylJDroUn7iZCmCPYCwnHr8xIWv/S82ZlL96h5LE70WQkEoQT6gpwetUOTPr/mbdkQ== Cloudmason AWX
        public_key: |
          ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQDfqDbmj069e3+TSG5oCY31aATY+iQNU9c61kGQhXjNaQyKd57krwElcV0Wp1i2tiXzVztLRBXquqstOYe38AvH9eXi1NcELauglJPNWv+UlBRjuxWUESEe0A6PGobW6Nd6c1GpIKrUgb7J/7bRhdEeXv3Irkw4Xtbamuv9lLckgH3XPiV54rgvth17iLLE1wgSkfEt64RvrP0cyOAyeLgDbu7wmr0vY+3rEA4iF80/yZW+ZzK0524eXBS1wpuKkMvhU1HJYyQhnAlEanq7pnFVd2mTXZ8PsAbrzCsjOF0I14hYlxEPWf0aonKHGAvR3J2ltY4OvzVbKnIDg1CUzR2NZILAvSoNICxE10NQuVCx5X8BpD6A8tBBBVVL9CzM7MSpCjpYh31ZX/9IaHFxCryGTSNBlMAyWvVUlu7GaL8EDv4+3ks86+YqEVmw+feoaT+Mx/mIm3tVCyV3KbXDDm6Pfg2Qfv4ny83to3Wh5b5+qafaJ0VoiIxUJWndvqN1VTTgB13OdXnAoQ454Y1YVgeH/DWYL4Nw8vow0UUdzjA+wjtP9xTyyJiEu/FIFPTib+f3uI4eyfq78fuut0pshDBdO3sh5sAtZcVRo91jCYDC8ylJDroUn7iZCmCPYCwnHr8xIWv/S82ZlL96h5LE70WQkEoQT6gpwetUOTPr/mbdkQ== Cloudmason AWX
        private_key: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          61353332653835353365613266613265356466366139616431366562373139343934623934383164
          3865316539613261396637366533313731353866623861390a636139366333383462333739393763
          37383132656130373763303835633633643961653532313331636339373735333366633437633033
          3133656435633130350a616263313338643536613634306533663638323261653832356136386161
          66333866636130656236643232333336366162383162333138613032616366303836626334313936
          36633635343534333461616131356530623237323236626532373766336533353032383361386539
          30663963356265326362666538663435386666343862306630643637383561613965643861613130
          38393136303862363739373061303534336537353866396538393034653437646438356663633235
          36653262663033313731336364323764623736353039313137306135356162373937653634633162
          33383761643965376235666636316162663030316630623533616562636465303137353461373661
          32373034386461636438303939633963623739666334396366353138313437373932613938653563
          30373330383532346233316633626262623136643130656162363635313932373035313434646634
          61326466343631633063646135373133646534646561623637326533396530373333306666353862
          65663064313666636361623264623762316631663231386637353432383633616163356330373731
          37363231313131656661313339343466356166303363623538613234613438323966323432616239
          37363036366563323330323133373064376366626334663036616463666561343931303135656430
          32616364326236396239636465646239306530303436643138383836336231646332646330323230
          32326463353636616232666164356336626336343039616336393834303866616161633930643065
          37663638353338633738356639323537613365396261316564383065633536663932316263656665
          39396338373839346231323438343163303833306163363166663539343261383732343438363666
          62336232613437366431333735383033336334366631393536373161306231623963393765636434
          32313838316238323030363835343963663939343936356165343334633636303462623364666336
          30326330663138303937313433646134316462376537633336363030363566643364626433323662
          63363765363939353661636131333732353963396232306332323631633566653736393130613533
          35626433616530613238353838643834626432393333346562626165623865333562306538386436
          39303266616536656630656536343763613939333437383563613065366566303961343537623235
          36393238323337373435636331646135616638303663636163306630303133663837363762666665
          34373863303666343537343538376235643136663336646564383032323034333964383035653166
          37353563313633396336616161386133656163333561366665323664393664666132303239623863
          63386562353431366530353831643732383530623530313632643436303232316639656136636533
          32313564653764323236353430303062653436363433663730623363353837313431623863383061
          31636362633539323939626366343430343037653864303434366464386261313966346535663639
          30373538323535383534626266366266383664356366646436383263333861663830666662386430
          65353237613665313965653132633766646634383939366339383837623639666663663732336566
          33383839326636656664663633636233313430626531363233323938653062633731616437373834
          32333032376464383562313463366561643430356334303033363064303639363235363937356432
          30326364626266396665343161336336386230373335333566616638633563343331396431306661
          32323066633966316533636533363662396633646466633964636635343739366265333831643665
          34363462663262633233386336353466366435306433333735323234646631646137363061363839
          35396364666461323864616565333764313961363663373265346262313838633865303461393936
          35353363306637376165326237326630373462303731373033303361353964646662393565386662
          63376661636465373338626661363161306466373663616361623766333666396535356465663430
          30643366356662363562306638666135653735306431633339316431656236356139643835626430
          39613139343738383165346361316230643039623234633538356235373061313166383034623433
          34336564653038316465363965623461383965363666303237373865653833383133333936363932
          33383331396431626638336437333237343836386166383732333131393064386562646235383663
          66393631376434373466333136666631653830396661663861306432663361643566663734393034
          65393139363261326231656232646436613761633138656232643430353232356630323638623863
          34663461383537366534306563633966626562336364653136663832396363336136656336376530
          32326534623932303133343937326164343630396634666235643139313734613635616330383261
          31353261383536303066636533646534316231653035336237373538613831636533656238336364
          38366464326462613935643635643335636335363331326261396432323462383237633132643934
          35306630636662346230343130393935613333623633326237376133663331393264346263626332
          35613561663562366562336631656661373361353237663731323564303431643461303763396238
          30366464323064316561623161653362343764626532326630633838653433363333623438623532
          61373735623236316362656631356239376262306162653832343661353135623462663936363466
          63363361653933346566356530396131663161303539326531633938326663393961663234393739
          37366161346533316431663932336530346265396533353336383330386636653730323231313731
          34313361353431376536623638643232666235623137613565366131633134313630316536663363
          61643831353630323163613864313437313535353462323832353737653430303835333132613631
          30326665386434333439633335376430383962346338353533326431613235613162306162646430
          35666564313962616236326364336630306331346233393833396565393364623136303538653432
          32363231623436393761633464396662323732306133356335383363633737386261326630393730
          32353565353936626233396134313664303539613338393330336536313866663261306536646665
          30653939363665346563373830306635386333313163636534386162333163343534306432376136
          36343731393033653962303765613764656434623030353239633465393035313232643237363639
          38303130633831643765363232343335343166303637306537393565636630643365663161373030
          65653966373135343434336465643162323265366464393661346532636234643937346138393030
          63646638343965623061623735636232623431316434323832653235636164353633323731616330
          36643332313761363938333437343031343332356438653731353234343339323333663439373234
          32333432336331316466636538323636336266623265356665366631303565656431346664373538
          65336337356139663833393633336231663138363034353263393961663762663637613136366264
          37346230666535313938626666666461656162366631666636366633616337376437653236336335
          62363734343738616433313561323434626132363963643433316535636537366334383932373766
          33303739633763666531616535626362636135303534303666613361356362303030333730643762
          36313633383464386565633831643930656466633633353334343030663932623339373365646165
          63636466643238616137373535656131663131346434373164383866626639393162316539636163
          31353037643261643135313332346138393633373863653766346331383464363062373031656363
          30373864333838636537326263383437356161613863366236383032373364343665313835656434
          35323333333366393739613739616133363134653165626434626262626432383235656461376533
          63623532663437643062653561633834316231386437333463643563383135656238666534636664
          65313331313631353731653361363938333666366230393438643933376332336330336231616530
          31613561303665303736653034626636653361323731373834323765363339336536333537383439
          33386432353061363433653838313564643561633265386333366431646535656665316439386136
          33343433343732376461333230616632396666613232313133356365303439613438326566383033
          33653830613339643533666133303232326464663630376362373632633230303033336236303463
          30623963643934616230353161313739356666656362653833656134393165613761333536626638
          30383736316663383234363933353161393432383266356664656136346562323265396561633266
          65343131613663313566376539323364316566656362663434363664343062353163323930333533
          37316165306236623837613333643538383835313162393733313761303033373734393839376264
          37623232303731386535666132316365303762393931376163626133303964613336353661623234
          36343366383138386163623839303563383262646566636535616463353830353331646534613461
          61303566613439373566663735343366363462323565366132656338363166656137303039303066
          64393863616438633537623163373139383438666462313666623032306330356565643563323339
          32393163633634363464666263653630656265643032613034643333333362343832343937663139
          33326235666639376364616461326461656339393062316662323131396564346631343761353231
          34393835636433346138663464386433623664323863306331633761366132613961366536383866
          38663832313961643435396165386139336262393832646637656139646235306635333336636163
          33636365323663303131613532333939623262326437376664313539303332356634356234303136
          38646462343334633533646435663937363166383062623532386464373565323761326438323365
          63653937636162363931366437396161383438363232386364306138333465303437326332383738
          30363662663837393461313533336339396537333634313065316535363431636164663833366339
          32396365303639333966613130316538656661663766666537383763366564633731306534663565
          36393030346230623866313932326536386236363134376133373264346331376164393362616163
          64373061363338643961396438336634396335616262303039663563393731663136313139663739
          66373534376532643738366334636232313932363561333562613864326233346161336331636434
          66346136356266336138343664323536363732346637306639323036333561666661626261363733
          39393433333838656435396135633734356436313963323439633639306464353865306337623431
          38306261303332353034663338363531303039393164366363383436303330663531663531323563
          30653738353735623432363263366137303238353866303939613766666165323062663666666362
          63323632373036356337343135636239363963646661383134636365363564313934616436326239
          38306332653638343966623835383266346333336464313465333435346536373361323862306138
          31613536666233653735613338636231633238303161393964623963343036353161663138396331
          61343030386164613334653866646635353232376335633736383035626366653136373830383465
          64343639383235336332383961343137386163646566643832396133326364373234646336306538
          32623538646666343036663130303330363662313466376430393366376230373836356664333338
          64353533383366636630373766643365646337396339353037306633636435623837383462303734
          64656666643131323964323537633130356333353066653039306433343332373839663333633863
          61383731633863333561616136306433303439643837646333393235356164653233646165386536
          39303931386166633162613431613239313664343162393266643931663434623931636533643264
          34326364646433383062336533643265616532616663386535353164363632626565633730383139
          36623466636663326237303766333735343237313538396231343730383632616463653632383730
          34643262333662396136303235356665613266356137336365356566653663366533326236663261
          66336637353331666534663638393564623435643864396461393030336563336333376137373834
          38346233386631396665343033313466313031343734326637333136326365666434383131333634
          37313763313033386239376461653035306631373237333666663234663361336161326637396363
          35646664356465336166353137663136363938363262326366626435363232333839613363613533
          34623833366638653730373538643836616131326438363931356364663731373539383531643037
          33303836323066386361653064313134386539663431666139393664393265306236363037663330
          34623738363464653261646230303762333362656465346363356538306536613632366363633635
          66313366623833373336653466656334356565663538363361343863353938346339313936303335
          31333334663861626264333139373933343937373333313431646266316565616163656263353434
          61633038646634633835663333353933306138643662663735333938353535656531303564333432
          38346663333532306362396532623766633230323035363636656534373537316563393733373332
          34643330386161623833663562633230353930366331663435353866636663613963653466643066
          31613236363631333464653363643439313730383434636338633437636536643963313931373262
          32333962396361393161373731616164386131653763333162316363633537613939636136316237
          35363464663939376531373465336232663066663032393866346438663264656136343638336637
          39346634616135353763613139313832343866303465303633653261633762316531313830343662
          66613362393138373239666164343366643839343463393039323762313936396437323632386233
          63666133366135373036373264333235306531626362396137623134343736366661363630383638
          33343036316534366533363964646438313539666266613832666134613066373665623063646238
          37393338383730353264303735663433313661336265376531323039356438396461336263633765
          36643065393365366266383764336638633231376637396130626561616263316439666433353361
          36363132383133313237393065343533663966386434323037663136346661373962366466326636
          38633933353638646566366535653764656434326636316661373665363134613563653165643263
          39336133623731396463616435353136386263313037663832373930373966643566366561326130
          66653132393432363530383338333335323633663262376433376238643032343365663938666135
          39613630316664396335386265633066356161373562636538623835636261323963656462633631
          35393766393231343362326139633166383461333333626565643635366637643134393232346230
          63393332353232633630643162663136353737386661336132363862653536626161666563333130
          64616261326135653533396332343438336232303433386435356639303364323932623861343037
          63343730383262313665326163363065626132663039656232333962636364313565616435653030
          66356237316637356365386636616635353939353838323337373931386633396364636362616636
          39643835653234646234616265383134303737363234353263393038663538303766636565613566
          64363638343431613964343837633561356139303331383835356562636366656233376135636131
          31333935326562643430333265343039353536353237316266376161316465626230663565396238
          66623363636231316431303332336464303030356136306663336433366263393561633830656533
          33353234323961613534313266613336313135613539636531306365386134636439613936336665
          63353365613730386436396137386236626230363366613338313833666235343239373064343530
          30386361646337393663656138386466636339313432626235626539303339646365626639643434
          32383137356338316665303564616536666461323039623035303334376431396638353330376231
          61353631353061323661303035363366376565623633656136353365346638316632366339393863
          30613634386661303732636336646265356335616461653564323366623061653061363036356331
          39346336326338643438646361393466343637653564373362373237663966383930653664636433
          33326362323930303331363862613364613135366632386534623837646537306237616339626466
          31376335393830343633666364663366313532666263396433303033616265633031383539663430
          38613632633935393561386366383366336232653261383838373363336133643864353133363733
          64303166613439363266326563326333356663336332386566313830393161363039326635316638
          64613264353437616239326562373237396266643962333261356263653234373337393862643639
          61643138373235616433353834623965383662383831336432383530396238393439336163623365
          61376636613763643762656363656362326432653738363739373535613432636135636663353366
          65633765313165643563396563346562643537353662613263346466613233366538

  tasks:

    - name: include awx role (config tasks)
      ansible.builtin.include_role:
        name: awx
        tasks_from: config.yml
        apply:
          tags: config
      tags: config

    - name: include awx role (user tasks)
      ansible.builtin.include_role:
        name: awx
        tasks_from: user.yml
        apply:
          tags: user
      tags: user
